---
title: "CA1875: Use 'Regex.Count' (code analysis)"
description: "Learn about code analysis rule CA1875: Use 'Regex.Count'"
ms.date: 10/27/2025
ms.topic: reference
f1_keywords:
  - CA1875
  - UseRegexCountAnalyzer
helpviewer_keywords:
  - CA1875
dev_langs:
  - CSharp
  - VB
ai-usage: ai-generated
---

# CA1875: Use 'Regex.Count'

| Property                            | Value                                  |
|-------------------------------------|----------------------------------------|
| **Rule ID**                         | CA1875                                 |
| **Title**                           | Use `Regex.Count`                      |
| **Category**                        | [Performance](performance-warnings.md) |
| **Fix is breaking or non-breaking** | Non-breaking                           |
| **Enabled by default in .NET 10**   | As suggestion                          |

## Cause

The <xref:System.Text.RegularExpressions.MatchCollection.Count> property of the `MatchCollection` from <xref:System.Text.RegularExpressions.Regex.Matches*?displayProperty=nameWithType> is used to get the count of matches.

## Rule description

<xref:System.Text.RegularExpressions.Regex.Count*?displayProperty=nameWithType> is simpler and faster than `Regex.Matches(...).Count`. The `Count()` method is optimized for counting matches without materializing the full <xref:System.Text.RegularExpressions.MatchCollection>. Calling `Matches()` and then accessing `.Count` does unnecessary work that can impact performance.

## How to fix violations

Replace calls to `Regex.Matches(...).Count` with `Regex.Count(...)`.

A *code fix* that automatically performs this transformation is available.

## Example

The following code snippet shows a violation of CA1875:

```csharp
using System.Text.RegularExpressions;

class Example
{
    public int CountWords(string text)
    {
        // Violation
        return Regex.Matches(text, @"\b\w+\b").Count;
    }
}
```

```vb
Imports System.Text.RegularExpressions

Class Example
    Public Function CountWords(text As String) As Integer
        ' Violation
        Return Regex.Matches(text, "\b\w+\b").Count
    End Function
End Class
```

The following code snippet fixes the violation:

```csharp
using System.Text.RegularExpressions;

class Example
{
    public int CountWords(string text)
    {
        // Fixed
        return Regex.Count(text, @"\b\w+\b");
    }
}
```

```vb
Imports System.Text.RegularExpressions

Class Example
    Public Function CountWords(text As String) As Integer
        ' Fixed
        Return Regex.Count(text, "\b\w+\b")
    End Function
End Class
```

## When to suppress warnings

It's safe to suppress a warning from this rule if performance isn't a concern or if you're targeting a version of .NET that doesn't include `Regex.Count` (prior to .NET 7).

## Suppress a warning

If you just want to suppress a single violation, add preprocessor directives to your source file to disable and then re-enable the rule.

```csharp
#pragma warning disable CA1875
// The code that's violating the rule is on this line.
#pragma warning restore CA1875
```

To disable the rule for a file, folder, or project, set its severity to `none` in the [configuration file](../configuration-files.md).

```ini
[*.{cs,vb}]
dotnet_diagnostic.CA1875.severity = none
```

For more information, see [How to suppress code analysis warnings](../suppress-warnings.md).

## See also

- [Performance rules](performance-warnings.md)
- <xref:System.Text.RegularExpressions.Regex.Count%2A?displayProperty=nameWithType>
- <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType>
